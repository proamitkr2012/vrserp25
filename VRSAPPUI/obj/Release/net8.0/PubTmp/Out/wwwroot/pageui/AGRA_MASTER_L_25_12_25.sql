USE [master]
GO
/****** Object:  Database [AGRA_MASTER]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE DATABASE [AGRA_MASTER]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'AGRA_MASTER', FILENAME = N'F:\DATABASES\AGRA_MASTER.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'AGRA_MASTER_log', FILENAME = N'F:\DATABASE_LOG_FILES\AGRA_MASTER_log.ldf' , SIZE = 73728KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT
GO
ALTER DATABASE [AGRA_MASTER] SET COMPATIBILITY_LEVEL = 150
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [AGRA_MASTER].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [AGRA_MASTER] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET ARITHABORT OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [AGRA_MASTER] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [AGRA_MASTER] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET  DISABLE_BROKER 
GO
ALTER DATABASE [AGRA_MASTER] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [AGRA_MASTER] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET RECOVERY FULL 
GO
ALTER DATABASE [AGRA_MASTER] SET  MULTI_USER 
GO
ALTER DATABASE [AGRA_MASTER] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [AGRA_MASTER] SET DB_CHAINING OFF 
GO
ALTER DATABASE [AGRA_MASTER] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [AGRA_MASTER] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [AGRA_MASTER] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [AGRA_MASTER] SET ACCELERATED_DATABASE_RECOVERY = OFF  
GO
ALTER DATABASE [AGRA_MASTER] SET QUERY_STORE = OFF
GO
USE [AGRA_MASTER]
GO
/****** Object:  User [webmaster]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE USER [webmaster] FOR LOGIN [webmaster] WITH DEFAULT_SCHEMA=[dbo]
GO
/****** Object:  User [vivek]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE USER [vivek] FOR LOGIN [vivek] WITH DEFAULT_SCHEMA=[dbo]
GO
/****** Object:  User [mridul]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE USER [mridul] FOR LOGIN [mridul] WITH DEFAULT_SCHEMA=[dbo]
GO
/****** Object:  User [amit]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE USER [amit] FOR LOGIN [amit] WITH DEFAULT_SCHEMA=[dbo]
GO
/****** Object:  User [akshat]    Script Date: 12/25/2025 4:39:29 PM ******/
CREATE USER [akshat] WITHOUT LOGIN WITH DEFAULT_SCHEMA=[dbo]
GO
ALTER ROLE [db_owner] ADD MEMBER [webmaster]
GO
ALTER ROLE [db_datareader] ADD MEMBER [webmaster]
GO
ALTER ROLE [db_datawriter] ADD MEMBER [webmaster]
GO
ALTER ROLE [db_owner] ADD MEMBER [vivek]
GO
ALTER ROLE [db_datareader] ADD MEMBER [vivek]
GO
ALTER ROLE [db_datawriter] ADD MEMBER [vivek]
GO
ALTER ROLE [db_owner] ADD MEMBER [mridul]
GO
ALTER ROLE [db_owner] ADD MEMBER [amit]
GO
ALTER ROLE [db_datareader] ADD MEMBER [amit]
GO
ALTER ROLE [db_datawriter] ADD MEMBER [amit]
GO
/****** Object:  UserDefinedFunction [dbo].[ProperCase]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create function [dbo].[ProperCase](@Text as varchar(8000))
returns varchar(8000)
as
begin
  declare @Reset bit;
  declare @Ret varchar(8000);
  declare @i int;
  declare @c char(1);

  if @Text is null
    return null;

  select @Reset = 1, @i = 1, @Ret = '';

  while (@i <= len(@Text))
    select @c = substring(@Text, @i, 1),
      @Ret = @Ret + case when @Reset = 1 then UPPER(@c) else LOWER(@c) end,
      @Reset = case when @c like '[a-zA-Z]' then 0 else 1 end,
      @i = @i + 1
  return @Ret
end
GO
/****** Object:  Table [dbo].[EXAM_TYPE_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[EXAM_TYPE_MASTER](
	[EX_TYPE_ID] [int] NOT NULL,
	[EXAM_TYPE] [varchar](25) NOT NULL,
	[EXAM_TYPE_SERIAL] [tinyint] NULL,
	[IS_ACTIVE] [bit] NOT NULL,
 CONSTRAINT [PK_EXAM_TYPE_MASTER] PRIMARY KEY CLUSTERED 
(
	[EX_TYPE_ID] ASC,
	[EXAM_TYPE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[FUN_GET_EXAMTYPE]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
CREATE FUNCTION  [dbo].[FUN_GET_EXAMTYPE]
(	
	 @EXAMTYPE_IDS VARCHAR(50) 
)
RETURNS TABLE 
AS
RETURN 
(
 
	SELECT  EXAM_TYPE FROM  EXAM_TYPE_MASTER 
	WHERE EXAM_TYPE_SERIAL  IN (SELECT VALUE FROM  STRING_SPLIT( @EXAMTYPE_IDS,','))
)
GO
/****** Object:  Table [dbo].[COLLEGE_MST]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COLLEGE_MST](
	[COLLEGE_CODE] [varchar](5) NOT NULL,
	[COLLEGE_NAME] [varchar](500) NULL,
	[COLLEGE_NAME_MAIN] [varchar](500) NULL,
	[STATE] [varchar](15) NULL,
	[DISTRICT] [varchar](25) NULL,
	[SYSTEM_DATE] [datetime] NOT NULL,
	[USER_ID] [int] NULL,
	[IS_ACTIVE] [bit] NOT NULL,
	[CREATED_BY] [int] NULL,
	[CREATED_ON] [datetime] NOT NULL,
	[CREATED_IP] [varchar](50) NULL,
	[UPDATED_BY] [int] NULL,
	[UPDATED_ON] [datetime] NULL,
	[UPDATED_IP] [varchar](50) NULL,
	[OTP] [nvarchar](10) NULL,
	[COLLEGE_TYPE_ID] [int] NULL,
	[ADDRESS] [nvarchar](200) NULL,
	[PIN_CODE] [nvarchar](7) NULL,
	[IS_WOMEN_COLLEGE] [bit] NOT NULL,
 CONSTRAINT [PK_COLLEGE_MST] PRIMARY KEY CLUSTERED 
(
	[COLLEGE_CODE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[COLLEGE_TYPE_MST]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COLLEGE_TYPE_MST](
	[COLLEGE_TYPE_ID] [int] NOT NULL,
	[COLLEGE_TYPE_NAME] [varchar](500) NULL,
	[IS_ACTIVE] [bit] NOT NULL,
	[CREATED_BY] [int] NULL,
	[CREATED_ON] [datetime] NOT NULL,
	[CREATED_IP] [varchar](50) NULL,
	[UPDATED_BY] [int] NULL,
	[UPDATED_ON] [datetime] NULL,
	[UPDATED_IP] [varchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[COURSE_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COURSE_MASTER](
	[COURSE_ID] [int] NOT NULL,
	[COURSE_ID_MAIN] [int] NOT NULL,
	[COURSE_NAME] [nvarchar](200) NOT NULL,
	[COURSE_NAME_PROPER] [nvarchar](200) NULL,
	[SEM_NO] [int] NOT NULL,
	[YEAR_NO] [int] NULL,
	[AGENCY_COURSE_ID] [varchar](5) NULL,
	[AGENCY_COURSE_NAME] [nvarchar](200) NULL,
	[AGENCY_SEM_NO] [int] NULL,
	[COURSE_TYPE] [varchar](50) NOT NULL,
	[COURSE_MODE] [varchar](10) NULL,
	[IS_ACTIVE] [bit] NOT NULL,
	[MARKSHEET_FORMAT_CODE] [varchar](25) NULL,
	[IS_NEP] [bit] NOT NULL,
	[SEMESTER_NAME] [nvarchar](50) NULL,
	[INTERNAL_EXPIRY_DATE] [datetime] NULL,
	[PRACTICAL_EXPIRY_DATE] [datetime] NULL,
	[CREATEON] [smalldatetime] NOT NULL,
	[UPDATEON] [smalldatetime] NULL,
	[IS_FINAL_YEAR_SEM] [bit] NOT NULL,
	[RESULT_PATTERN] [varchar](25) NULL,
 CONSTRAINT [PK_COURSE_MASTER] PRIMARY KEY CLUSTERED 
(
	[COURSE_ID] ASC,
	[COURSE_ID_MAIN] ASC,
	[COURSE_NAME] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[COURSE_MASTER_MAIN]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COURSE_MASTER_MAIN](
	[COURSE_ID_MAIN] [int] NOT NULL,
	[COURSE_NAME_MAIN] [nvarchar](200) NOT NULL,
	[COURSE_NAME_MAIN_PROPER] [nvarchar](200) NOT NULL,
	[IS_ACTIVE] [bit] NOT NULL,
 CONSTRAINT [PK_COURSE_MASTER_MAIN] PRIMARY KEY CLUSTERED 
(
	[COURSE_ID_MAIN] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[COURSE_TYPE_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[COURSE_TYPE_MASTER](
	[COURSE_TYPE] [varchar](5) NOT NULL,
	[COURSE_TYPE_NAME] [varchar](50) NOT NULL,
	[IS_VISIBLE] [bit] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[FACULTY_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FACULTY_MASTER](
	[FACULTY_MASTER_ID] [int] IDENTITY(1,1) NOT NULL,
	[FACULTY] [nvarchar](100) NULL,
	[FACULTY_FULL_NAME] [nvarchar](500) NULL,
	[COURSE_ID_MAIN] [int] NULL,
	[IS_ACTIVE] [bit] NULL,
	[CREATED_BY] [int] NULL,
	[CREATED_DATE] [datetime] NULL,
	[UPDATED_BY] [int] NULL,
	[UPDATED_DATE] [datetime] NULL,
PRIMARY KEY CLUSTERED 
(
	[FACULTY_MASTER_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ORDINANCE]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ORDINANCE](
	[ORDINANCE_ID] [int] IDENTITY(1,1) NOT NULL,
	[ORDINANCE_NAME] [nvarchar](200) NOT NULL,
	[RESULT_TYPE_ID] [smallint] NOT NULL,
	[IS_RW] [bit] NOT NULL,
	[SUBJECT_COUNT] [tinyint] NOT NULL,
	[PAPER_COUNT] [tinyint] NOT NULL,
	[COMPULSORY_PAPER_COUNT] [tinyint] NOT NULL,
	[OPTIONAL_PAPER_COUNT] [tinyint] NOT NULL,
	[MAJOR_PAPER_COUNT] [tinyint] NOT NULL,
	[VOCATIONAL_PAPER_COUNT] [tinyint] NOT NULL,
	[QUALIFY_PAPER_COUNT] [tinyint] NOT NULL,
	[RESEARCH_PAPER_COUNT] [tinyint] NOT NULL,
	[PRACTICAL_PAPER_COUNT] [tinyint] NOT NULL,
	[TOTAL_MAJOR_CR] [tinyint] NOT NULL,
	[VOCATIONAL_CR] [tinyint] NOT NULL,
	[RESEARCH_CR] [tinyint] NOT NULL,
	[SEMCREDIT] [tinyint] NULL,
	[TOTALCREDIT] [smallint] NULL,
	[ALLOW_GRACE] [bit] NOT NULL,
	[GRACE] [tinyint] NOT NULL,
	[GRACE_IF_PASSED_AGG] [bit] NOT NULL,
	[GRACE_APPLY_EXAM_TYPE] [varchar](50) NULL,
	[RESULT_PASS_PERCENT] [decimal](18, 2) NOT NULL,
	[THEORY_MAX] [int] NOT NULL,
	[THEORY_MIN] [int] NOT NULL,
	[PRACTICAL_MAX] [int] NOT NULL,
	[PRACTICAL_MIN] [int] NOT NULL,
	[TOTAL_MAX] [smallint] NOT NULL,
	[TOTAL_MIN] [smallint] NOT NULL,
	[ADD_PRAC_IN_TOTAL_MARKS] [bit] NOT NULL,
	[GRAND_MAX] [int] NOT NULL,
	[GRAND_MIN] [int] NOT NULL,
	[FINAL_YEAR_SEM] [bit] NOT NULL,
	[I_DIV_MAX_CGPA_PERCENT] [decimal](18, 3) NULL,
	[I_DIV_MIN_CGPA_PERCENT] [decimal](18, 3) NULL,
	[II_DIV_MAX_CGPA_PERCENT] [decimal](18, 3) NULL,
	[II_DIV_MIN_CGPA_PERCENT] [decimal](18, 3) NULL,
	[III_DIV_MAX_CGPA_PERCENT] [decimal](18, 3) NULL,
	[III_DIV_MIN_CGPA_PERCENT] [decimal](18, 3) NULL,
	[I_DIV_MAX_PRAC_PERCENT] [decimal](18, 3) NULL,
	[I_DIV_MIN_PRAC_PERCENT] [decimal](18, 3) NULL,
	[II_DIV_MAX_PRAC_PERCENT] [decimal](18, 3) NULL,
	[II_DIV_MIN_PRAC_PERCENT] [decimal](18, 3) NULL,
	[III_DIV_MAX_PRAC_PERCENT] [decimal](18, 3) NULL,
	[III_DIV_MIN_PRAC_PERCENT] [decimal](18, 3) NULL,
	[FAIL_PAPER_FOR_BACK] [int] NOT NULL,
	[AGG_MARKS_PAPER_FOR_BACK] [decimal](18, 3) NOT NULL,
 CONSTRAINT [PK_ORDINANCE_1] PRIMARY KEY CLUSTERED 
(
	[ORDINANCE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ORDINANCE_DETAILS]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ORDINANCE_DETAILS](
	[ORD_DETAILS_ID] [int] IDENTITY(1,1) NOT NULL,
	[ORDINANCE_ID] [int] NOT NULL,
	[PAPER_TYPE_CAT] [varchar](5) NOT NULL,
	[PAPER_CREDIT] [int] NOT NULL,
	[THEORY_MAX] [int] NULL,
	[THEORY_MIN] [int] NOT NULL,
	[THEORY_PASS_PERCENT] [decimal](16, 2) NOT NULL,
	[INTERNAL_MAX] [int] NULL,
	[INTERNAL_MIN] [int] NULL,
	[INTERNAL_PASS_PERCENT] [decimal](16, 2) NULL,
	[SESSIONAL_MAX] [int] NULL,
	[SESSIONAL_MIN] [int] NULL,
	[SESSIONAL_PASS_PERCENT] [decimal](16, 2) NULL,
	[PAPER_TOTAL_MAX] [int] NOT NULL,
	[PAPER_TOTAL_MIN] [int] NOT NULL,
	[PAPER_TOTAL_PASS_PERCENT] [decimal](16, 2) NOT NULL,
	[THEORY_CHECK] [bit] NOT NULL,
	[INTERNAL_CHECK] [bit] NOT NULL,
	[SESSIONAL_CHECK] [bit] NOT NULL,
	[PAPER_TOTAL_CHECK] [bit] NOT NULL,
	[IS_DELETED] [bit] NOT NULL,
	[CREATEON] [smalldatetime] NOT NULL,
	[UPDATEON] [smalldatetime] NULL,
 CONSTRAINT [PK_ORDINANCE_DETAILS] PRIMARY KEY CLUSTERED 
(
	[ORD_DETAILS_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PAPER_TYPE_CATEGORY]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PAPER_TYPE_CATEGORY](
	[ID] [int] NOT NULL,
	[PAPER_TYPE_NAME] [varchar](50) NOT NULL,
	[PTYPE] [varchar](5) NULL,
	[IS_VISIBLE] [bit] NOT NULL,
	[PAPER_MASTER_TYPE] [varchar](2) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PAPER_TYPE_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PAPER_TYPE_MASTER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[PAPER_TYPE_NAME] [varchar](50) NOT NULL,
	[PTYPE] [varchar](5) NULL,
	[IS_VISIBLE] [bit] NOT NULL,
 CONSTRAINT [PK_PAPER_TYPE_MASTER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[RESULT_TYPE]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RESULT_TYPE](
	[RESULT_TYPE_ID] [int] IDENTITY(1,1) NOT NULL,
	[RESULT_TYPE] [nvarchar](250) NOT NULL,
 CONSTRAINT [PK_RESULT_TYPE] PRIMARY KEY CLUSTERED 
(
	[RESULT_TYPE_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[RESULTTYPE_WISE_ORDINANCE]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RESULTTYPE_WISE_ORDINANCE](
	[ORD_RESULTTYPE_ASS_ID] [int] IDENTITY(1,1) NOT NULL,
	[RESULT_TYPE_ID] [int] NOT NULL,
	[COURSE_ID] [int] NULL,
	[ORDINANCE_ID] [int] NULL,
	[PROC_NAME] [varchar](500) NOT NULL,
	[IsACTIVE] [bit] NOT NULL,
 CONSTRAINT [PK_RESULTTYPE_WISE_ORDINANCE] PRIMARY KEY CLUSTERED 
(
	[ORD_RESULTTYPE_ASS_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[SESSION_MASTER]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SESSION_MASTER](
	[SESSION_ID] [int] NOT NULL,
	[SESSIONS] [varchar](15) NOT NULL,
	[START_YEAR] [varchar](10) NULL,
	[ENDYEAR_YEAR] [varchar](50) NULL,
	[ISACTIVE] [bit] NOT NULL,
 CONSTRAINT [PK_SESSION_MASTER] PRIMARY KEY CLUSTERED 
(
	[SESSION_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[COLLEGE_MST] ADD  CONSTRAINT [DF__COLLEGE_M__SYSTE__3D5E1FD2]  DEFAULT (getdate()) FOR [SYSTEM_DATE]
GO
ALTER TABLE [dbo].[COLLEGE_MST] ADD  CONSTRAINT [DF__COLLEGE_M__IS_AC__3E52440B]  DEFAULT ((1)) FOR [IS_ACTIVE]
GO
ALTER TABLE [dbo].[COLLEGE_MST] ADD  CONSTRAINT [DF__COLLEGE_M__CREAT__3F466844]  DEFAULT (getdate()) FOR [CREATED_ON]
GO
ALTER TABLE [dbo].[COLLEGE_MST] ADD  CONSTRAINT [DF__COLLEGE_M__IS_WO__17236851]  DEFAULT ((0)) FOR [IS_WOMEN_COLLEGE]
GO
ALTER TABLE [dbo].[COURSE_MASTER] ADD  CONSTRAINT [DF_COURSE_MASTER_CREATEON]  DEFAULT (getdate()) FOR [CREATEON]
GO
ALTER TABLE [dbo].[COURSE_MASTER] ADD  CONSTRAINT [DF_COURSE_MASTER_IS_FINAL_YEAR_SEM]  DEFAULT ((0)) FOR [IS_FINAL_YEAR_SEM]
GO
ALTER TABLE [dbo].[COURSE_MASTER] ADD  CONSTRAINT [DF_COURSE_MASTER_RESULT_PATTERN]  DEFAULT ('') FOR [RESULT_PATTERN]
GO
ALTER TABLE [dbo].[EXAM_TYPE_MASTER] ADD  CONSTRAINT [DF__EXAM_TYPE__IS_AC__2B3F6F97]  DEFAULT ((0)) FOR [IS_ACTIVE]
GO
ALTER TABLE [dbo].[FACULTY_MASTER] ADD  DEFAULT ((1)) FOR [IS_ACTIVE]
GO
ALTER TABLE [dbo].[FACULTY_MASTER] ADD  DEFAULT (getdate()) FOR [CREATED_DATE]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_MARKS_GRADE_SYS]  DEFAULT ((1)) FOR [RESULT_TYPE_ID]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_IS_RW]  DEFAULT ((0)) FOR [IS_RW]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_SUBJECT_COUNT]  DEFAULT ((0)) FOR [SUBJECT_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_PAPER_COUNT]  DEFAULT ((0)) FOR [PAPER_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_OPTIONAL_PAPER_COUNT]  DEFAULT ((0)) FOR [OPTIONAL_PAPER_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_MAJOR_PAPER_COUNT]  DEFAULT ((0)) FOR [MAJOR_PAPER_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_RESEARCH_PAPER_COUNT]  DEFAULT ((0)) FOR [RESEARCH_PAPER_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_PRACTICAL_PAPER_COUNT]  DEFAULT ((0)) FOR [PRACTICAL_PAPER_COUNT]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_RESEARCH_CR]  DEFAULT ((0)) FOR [RESEARCH_CR]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_ALLOW_GRACE]  DEFAULT ((0)) FOR [ALLOW_GRACE]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_GRACE]  DEFAULT ((0)) FOR [GRACE]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_GRASS_IF_PASSED_AGG]  DEFAULT ((0)) FOR [GRACE_IF_PASSED_AGG]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_TOTAL_THEORY_MAX]  DEFAULT ((0)) FOR [TOTAL_MAX]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_TOTAL_THEORY_MIN]  DEFAULT ((0)) FOR [TOTAL_MIN]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_ADD_PRAC_IN_TOTAL_MARKS]  DEFAULT ((1)) FOR [ADD_PRAC_IN_TOTAL_MARKS]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_FINAL_YEAR_SEM]  DEFAULT ((0)) FOR [FINAL_YEAR_SEM]
GO
ALTER TABLE [dbo].[ORDINANCE] ADD  CONSTRAINT [DF_ORDINANCE_AGG_MARKS_PAPER_FOR_BACK]  DEFAULT ((0)) FOR [AGG_MARKS_PAPER_FOR_BACK]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_THEORY_CHECK]  DEFAULT ((1)) FOR [THEORY_CHECK]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_INTERNAL_CHECK]  DEFAULT ((0)) FOR [INTERNAL_CHECK]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_SESSIONAL_CHECK]  DEFAULT ((0)) FOR [SESSIONAL_CHECK]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_PAPER_TOTAL_CHECK]  DEFAULT ((0)) FOR [PAPER_TOTAL_CHECK]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_IS_DELETED]  DEFAULT ((0)) FOR [IS_DELETED]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] ADD  CONSTRAINT [DF_ORDINANCE_DETAILS_CREATEON]  DEFAULT (getdate()) FOR [CREATEON]
GO
ALTER TABLE [dbo].[RESULTTYPE_WISE_ORDINANCE] ADD  CONSTRAINT [DF_RESULTTYPE_WISE_ORDINANCE_IsACTIVE]  DEFAULT ((1)) FOR [IsACTIVE]
GO
ALTER TABLE [dbo].[SESSION_MASTER] ADD  CONSTRAINT [DF_SESSION_MASTER_IS_DEFAULT]  DEFAULT ((0)) FOR [ISACTIVE]
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_ORDINANCE_DETAILS_ORDINANCE] FOREIGN KEY([ORDINANCE_ID])
REFERENCES [dbo].[ORDINANCE] ([ORDINANCE_ID])
GO
ALTER TABLE [dbo].[ORDINANCE_DETAILS] CHECK CONSTRAINT [FK_ORDINANCE_DETAILS_ORDINANCE]
GO
/****** Object:  StoredProcedure [dbo].[ApplyOrdinance_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC  [dbo].[ApplyOrdinance_AM]
(
 @CollegeCode VARCHAR(8000) ='0005'
,@COURSE_ID INT =111
,@EXAM_TYPE_ID  VARCHAR(15)='REGULAR'
,@SESSION_ID VARCHAR(20)='2024-25'
,@ROLL_NO VARCHAR(50) ='2500050010091'
,@IS_RW BIT=0
,@flag varchar(100)=NULL
)
AS

declare @PROCNAME varchar(2000)
 

select @PROCNAME=PROC_NAME from ORDINANCE WHERE ORDINANCE_ID=(SELECT ORDINANCE_ID FROM SESSION_WISE_ORDINANCE WHERE [SESSION]=@SESSION_ID)

select @PROCNAME 
 

 

  
GO
/****** Object:  StoredProcedure [dbo].[AuthenticateAdmin_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create PROCEDURE [dbo].[AuthenticateAdmin_AM] (
@Flag			VARCHAR(100),
@userName		VARCHAR(100),
@Password		VARCHAR(50)
)

/* 

   EXEC [dbo].[AuthenticateAdmin_AM] '','',''

*/

AS
BEGIN
		
SELECT *
FROM AdminMasters where (Email= @userName or Name= @userName) and Password=@Password
END
GO
/****** Object:  StoredProcedure [dbo].[GET_COURSE_MASTER_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_COURSE_MASTER_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT,
     @PageNumber INT       
    ,@Search VARCHAR(500) NULL  
AS  
 
  
--------//  GET_COURSE_MASTER_AM '',0,100,''  
   
BEGIN  
      SET NOCOUNT ON;     
      DECLARE @PageSize INT  =10;
      DECLARE @RecordCount INT =0;
      DECLARE @Totalpage int  =0


      SELECT @RecordCount = COUNT(*)
      FROM COURSE_MASTER WITH(NOLOCK) 
       WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND (COURSE_NAME LIKE '%'+@Search+'%'  OR  COURSE_NAME_PROPER LIKE '%'+@Search+'%')   ))

       set @Totalpage=@RecordCount/@PageSize+(IIF( @RecordCount%@PageSize>0,1,0 ))
       --SELECT @Totalpage

        SET @PageNumber =IIF(ISNULL(@Search,'')<>'' AND @Totalpage>=@PageNumber,@PageNumber,IIF(ISNULL(@Search,'')='' AND @Totalpage>=@PageNumber,@PageNumber,1))
         
         SELECT @RecordCount RecordCount,@PageSize PageSize,@PageNumber PageCurrent  
	
 ;  WITH TEMP AS 
      (
      
    SELECT  ROW_NUMBER()OVER(ORDER BY COURSE_ID DESC ) SrNo,* FROM 
    
    ( 
      SELECT  TOP (@PageNumber*@PageSize)    [COURSE_ID], [COURSE_ID_MAIN], [COURSE_NAME], [COURSE_NAME_PROPER], [SEM_NO], [YEAR_NO],
      [AGENCY_COURSE_ID], [AGENCY_COURSE_NAME], [AGENCY_SEM_NO],
      [COURSE_TYPE], [COURSE_MODE], [IS_ACTIVE], [MARKSHEET_FORMAT_CODE], [IS_NEP], 
      [SEMESTER_NAME], [INTERNAL_EXPIRY_DATE],
      [PRACTICAL_EXPIRY_DATE] 
      FROM COURSE_MASTER(NOLOCK)
      WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND (COURSE_NAME LIKE '%'+@Search+'%'  OR  COURSE_NAME_PROPER LIKE '%'+@Search+'%')   ))

      
      ) AS A
     
  )
		 SELECT * FROM TEMP WHERE
		 
		 SrNo between (@PageNumber - 1) * @PageSize + 1 and @PageNumber*@PageSize

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_MANAGECOURSEMASTER_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_MANAGECOURSEMASTER_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  
AS  
 
  
--------//  GET_MANAGECOURSEMASTER_AM '',0  
   
BEGIN  
      SELECT  COURSE_ID_MAIN,COURSE_NAME_MAIN FROM COURSE_MASTER_MAIN(NOLOCK);
      SELECT  COURSE_TYPE,COURSE_TYPE_NAME FROM dbo.COURSE_TYPE_MASTER(NOLOCK);
      SELECT DISTINCT COURSE_MODE  FROM dbo.COURSE_MASTER(NOLOCK);

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_MANAGEORDINANCEDETAILS_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_MANAGEORDINANCEDETAILS_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  
AS  
 
  
--------//  GET_MANAGEORDINANCEDETAILS_AM '',0  
   
BEGIN  
      SELECT  ORDINANCE_ID,ORDINANCE_NAME FROM dbo.ORDINANCE(NOLOCK);
      SELECT  ID,PAPER_TYPE_NAME,PTYPE,IS_VISIBLE FROM dbo.PAPER_TYPE_MASTER(NOLOCK);
      

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_MANAGEORDINANCEMAPPING_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_MANAGEORDINANCEMAPPING_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  ,
	 @RESULT_TYPE_ID INT=0 
AS  
 
  
--------//  GET_MANAGEORDINANCEMAPPING_AM '',0  ,0
   
BEGIN  
      SELECT  RESULT_TYPE_ID,RESULT_TYPE FROM dbo.RESULT_TYPE(NOLOCK);
      SELECT  COURSE_ID,COURSE_ID_MAIN,COURSE_NAME,COURSE_NAME_PROPER FROM dbo.COURSE_MASTER(NOLOCK);
      SELECT ORDINANCE_ID,ORDINANCE_NAME FROM dbo.ORDINANCE(NOLOCK) --WHERE RESULT_TYPE_ID= @RESULT_TYPE_ID
      

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_MANAGEORDINANCEMASTER_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_MANAGEORDINANCEMASTER_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  
AS  
 
  
--------//  GET_MANAGEORDINANCEMASTER_AM '',0  
   
BEGIN  
      SELECT  RESULT_TYPE_ID,RESULT_TYPE FROM dbo.RESULT_TYPE(NOLOCK);
      SELECT  COURSE_ID,COURSE_ID_MAIN,COURSE_NAME,COURSE_NAME_PROPER FROM dbo.COURSE_MASTER(NOLOCK);
      SELECT  SESSION_ID,SESSIONS,START_YEAR,ENDYEAR_YEAR,ISACTIVE FROM dbo.SESSION_MASTER(NOLOCK) ORDER BY ISACTIVE DESC;
      
	  SELECT  EX_TYPE_ID,EXAM_TYPE FROM dbo.EXAM_TYPE_MASTER(NOLOCK);
END  
GO
/****** Object:  StoredProcedure [dbo].[GET_ORDINANCE_DETAILS_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_ORDINANCE_DETAILS_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT,
     @PageNumber INT       
    ,@Search VARCHAR(500) NULL  
AS  
 
  
--------//  GET_ORDINANCE_DETAILS_AM '',0,100,''  
   
BEGIN  
      SET NOCOUNT ON;     
      DECLARE @PageSize INT  =10;
      DECLARE @RecordCount INT =0;
      DECLARE @Totalpage int  =0


      SELECT @RecordCount = COUNT(*)
      FROM ORDINANCE_DETAILS WITH(NOLOCK) 
      -- WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND (o LIKE '%'+@Search+'%'  OR  PROC_NAME LIKE '%'+@Search+'%')   ))

       set @Totalpage=@RecordCount/@PageSize+(IIF( @RecordCount%@PageSize>0,1,0 ))
       --SELECT @Totalpage

        SET @PageNumber =IIF(ISNULL(@Search,'')<>'' AND @Totalpage>=@PageNumber,@PageNumber,IIF(ISNULL(@Search,'')='' AND @Totalpage>=@PageNumber,@PageNumber,1))
         
         SELECT @RecordCount RecordCount,@PageSize PageSize,@PageNumber PageCurrent  
	
 ;  WITH TEMP AS 
      (
      
    SELECT  ROW_NUMBER()OVER(ORDER BY ORD_DETAILS_ID DESC ) SrNo,* FROM 
    
    ( 
      SELECT  TOP (@PageNumber*@PageSize)  
	  [ORD_DETAILS_ID], ORDINANCE.ORDINANCE_ID, [PAPER_TYPE_CAT], [PAPER_CREDIT], ORDINANCE_DETAILS.[THEORY_MAX], ORDINANCE_DETAILS.[THEORY_MIN], [THEORY_PASS_PERCENT], [INTERNAL_MAX], [INTERNAL_MIN], [INTERNAL_PASS_PERCENT], [SESSIONAL_MAX], [SESSIONAL_MIN], [SESSIONAL_PASS_PERCENT], [PAPER_TOTAL_MAX], [PAPER_TOTAL_MIN], [PAPER_TOTAL_PASS_PERCENT], [IS_DELETED], [CREATEON], [UPDATEON],[THEORY_CHECK], [INTERNAL_CHECK], [SESSIONAL_CHECK],[PAPER_TOTAL_CHECK],ORDINANCE_NAME
      FROM ORDINANCE_DETAILS(NOLOCK)
	  JOIN dbo.ORDINANCE ON ORDINANCE.ORDINANCE_ID = ORDINANCE_DETAILS.ORDINANCE_ID
          
    --  WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND (ORDINANCE_NAME LIKE '%'+@Search+'%'  OR  PROC_NAME LIKE '%'+@Search+'%')   ))

      
      ) AS A
     
  )
		 SELECT * FROM TEMP WHERE
		 
		 SrNo between (@PageNumber - 1) * @PageSize + 1 and @PageNumber*@PageSize
		 --DROP TEMP

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_ORDINANCE_MAPPING_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_ORDINANCE_MAPPING_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT,
     @PageNumber INT       
    ,@Search VARCHAR(500) NULL  
AS  
 
  
--------//  [GET_ORDINANCE_MAPPING_AM] '',0,100,''  
   
BEGIN  
      SET NOCOUNT ON;     
      DECLARE @PageSize INT  =10;
      DECLARE @RecordCount INT =0;
      DECLARE @Totalpage int  =0


      SELECT @RecordCount = COUNT(*)
      FROM dbo.RESULTTYPE_WISE_ORDINANCE W WITH(NOLOCK) 
	   JOIN dbo.ORDINANCE o ON w.ORDINANCE_ID =o.ORDINANCE_ID
       WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND ORDINANCE_NAME LIKE '%'+@Search+'%' ))

       set @Totalpage=@RecordCount/@PageSize+(IIF( @RecordCount%@PageSize>0,1,0 ))
       --SELECT @Totalpage

        SET @PageNumber =IIF(ISNULL(@Search,'')<>'' AND @Totalpage>=@PageNumber,@PageNumber,IIF(ISNULL(@Search,'')='' AND @Totalpage>=@PageNumber,@PageNumber,1))
         
         SELECT @RecordCount RecordCount,@PageSize PageSize,@PageNumber PageCurrent  
	
 ;  WITH TEMP AS 
      (
      
    SELECT  ROW_NUMBER()OVER(ORDER BY ORD_RESULTTYPE_ASS_ID DESC ) SrNo,* FROM 
    
    ( 
      SELECT  TOP (@PageNumber*@PageSize)   w.ORD_RESULTTYPE_ASS_ID ,o.[ORDINANCE_ID], o.[ORDINANCE_NAME], w.[RESULT_TYPE_ID],rt.RESULT_TYPE RESULT_TYPE_NAME ,w.IsACTIVE,w.COURSE_ID,c.COURSE_NAME,w.PROC_NAME
      FROM RESULTTYPE_WISE_ORDINANCE w (NOLOCK)
	  JOIN dbo.ORDINANCE o ON w.ORDINANCE_ID =o.ORDINANCE_ID
	  JOIN dbo.RESULT_TYPE rt ON w.RESULT_TYPE_ID =rt.RESULT_TYPE_ID
	  JOIN dbo.COURSE_MASTER c ON w.COURSE_ID =c.COURSE_ID

      WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND ORDINANCE_NAME LIKE '%'+@Search+'%' ))
	   ORDER BY ORDINANCE_ID,COURSE_ID

      
      ) AS A
     
  )
		 SELECT * FROM TEMP WHERE
		 
		 SrNo between (@PageNumber - 1) * @PageSize + 1 and @PageNumber*@PageSize
		
END  
GO
/****** Object:  StoredProcedure [dbo].[GET_ORDINANCE_MASTER_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_ORDINANCE_MASTER_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT,
     @PageNumber INT       
    ,@Search VARCHAR(500) NULL  
AS  
 
  
--------//  GET_ORDINANCE_MASTER_AM '',0,100,''  
   
BEGIN  
      SET NOCOUNT ON;     
      DECLARE @PageSize INT  =10;
      DECLARE @RecordCount INT =0;
      DECLARE @Totalpage int  =0


      SELECT @RecordCount = COUNT(*)
      FROM ORDINANCE WITH(NOLOCK) 
       WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND ORDINANCE_NAME LIKE '%'+@Search+'%' ))

       set @Totalpage=@RecordCount/@PageSize+(IIF( @RecordCount%@PageSize>0,1,0 ))
       --SELECT @Totalpage

        SET @PageNumber =IIF(ISNULL(@Search,'')<>'' AND @Totalpage>=@PageNumber,@PageNumber,IIF(ISNULL(@Search,'')='' AND @Totalpage>=@PageNumber,@PageNumber,1))
         
         SELECT @RecordCount RecordCount,@PageSize PageSize,@PageNumber PageCurrent  
	
 ;  WITH TEMP AS 
      (
      
    SELECT  ROW_NUMBER()OVER(ORDER BY ORDINANCE_ID DESC ) SrNo,* FROM 
    
    ( 
      SELECT  TOP (@PageNumber*@PageSize)    [ORDINANCE_ID], [ORDINANCE_NAME], [RESULT_TYPE_ID],  [IS_RW],  [SUBJECT_COUNT], [PAPER_COUNT], [COMPULSORY_PAPER_COUNT], [OPTIONAL_PAPER_COUNT],  [GRACE], [RESULT_PASS_PERCENT], [THEORY_MAX], [THEORY_MIN], [PRACTICAL_MAX], [PRACTICAL_MIN], [GRAND_MAX], [GRAND_MIN], [FINAL_YEAR_SEM], [I_DIV_MAX_CGPA_PERCENT], [I_DIV_MIN_CGPA_PERCENT], [II_DIV_MAX_CGPA_PERCENT], [II_DIV_MIN_CGPA_PERCENT], [III_DIV_MAX_CGPA_PERCENT], [III_DIV_MIN_CGPA_PERCENT], [FAIL_PAPER_FOR_BACK], [AGG_MARKS_PAPER_FOR_BACK]
      FROM ORDINANCE(NOLOCK)
      WHERE ( (ISNULL(@Search,'')='' AND 1=1)  OR (ISNULL(@Search,'')<>'' AND LEN(@Search)>=1 AND ORDINANCE_NAME LIKE '%'+@Search+'%' ))

      
      ) AS A
     
  )
		 SELECT * FROM TEMP WHERE
		 
		 SrNo between (@PageNumber - 1) * @PageSize + 1 and @PageNumber*@PageSize

END  
GO
/****** Object:  StoredProcedure [dbo].[Get_Ordinance_Student_Apply_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[Get_Ordinance_Student_Apply_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  ,
	 @Search VARCHAR(50),
	 @COURSE_ID INT=0,
	 @SESSIONNAME VARCHAR(50)
AS  
 
  
--------//  [Get_Ordinance_Student_Apply_AM] '',0,'',141,'2022-23'
   
BEGIN  
	  SELECT  COURSE_ID,COURSE_ID_MAIN,COURSE_NAME,COURSE_NAME_PROPER FROM dbo.COURSE_MASTER(NOLOCK) ORDER BY COURSE_NAME;
	  SELECT  SESSION_ID,SESSIONS,START_YEAR,ENDYEAR_YEAR,ISACTIVE FROM dbo.SESSION_MASTER(NOLOCK) ORDER BY ISACTIVE DESC;
     SELECT ORDINANCE_ID,ORDINANCE_NAME FROM dbo.ORDINANCE(NOLOCK) 
      SELECT  EX_TYPE_ID,EXAM_TYPE FROM dbo.EXAM_TYPE_MASTER(NOLOCK);


	  SELECT  [EXAM_IN_SESS_ID] ,[SESSION_ID_FK]  ,[COURSE_ID_FK]  ,[HELD_IN] ,[EXAM_FREQUENCY] FROM [AGRA_RESULT_DEMO].[dbo].[EXAM_IN_SESSION] (NOLOCK) e
	  JOIN dbo.SESSION_MASTER s ON e.SESSION_ID_FK=s.SESSION_ID
	  WHERE 
	  s.SESSIONS=@SESSIONNAME AND 
	  e.COURSE_ID_FK=@COURSE_ID  

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_ORDINANCEAPPLY_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_ORDINANCEAPPLY_AM]  
	 @Flag VARCHAR(100),
	 @UserId INT  
AS  
 
  
--------//  GET_ORDINANCEAPPLY_AM '',0  
   
BEGIN  
      SELECT  EX_TYPE_ID,EXAM_TYPE FROM dbo.EXAM_TYPE_MASTER(NOLOCK);
      SELECT  COURSE_ID,COURSE_ID_MAIN,COURSE_NAME,COURSE_NAME_PROPER FROM dbo.COURSE_MASTER(NOLOCK);
      SELECT  SESSION_ID,SESSIONS,START_YEAR,ENDYEAR_YEAR,ISACTIVE FROM dbo.SESSION_MASTER(NOLOCK) ORDER BY ISACTIVE DESC;
      SELECT  CollegeId,Code CollegeCode,Name CollegeName,CollegeType,IsRWCollege FROM AgraUniversityExams2023.dbo.Colleges ORDER BY Name ;
        SELECT  RESULT_TYPE_ID,RESULT_TYPE FROM dbo.RESULT_TYPE(NOLOCK);

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_PAPERTYPEMASTER_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_PAPERTYPEMASTER_AM]  
	 @Flag VARCHAR(100),
	 @PAPER_MASTER_TYPE VARCHAR(2)  
AS  
 
  
--------//  GET_PAPERTYPEMASTER_AM '','p'
   
BEGIN  
      SELECT [ID], [PAPER_TYPE_NAME], [PTYPE], [IS_VISIBLE], [PAPER_MASTER_TYPE]  FROM dbo.PAPER_TYPE_CATEGORY(NOLOCK) 
      WHERE PAPER_MASTER_TYPE=@PAPER_MASTER_TYPE
	  ORDER BY PAPER_TYPE_NAME

END  
GO
/****** Object:  StoredProcedure [dbo].[GET_StudentManageData_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 CREATE PROCEDURE [dbo].[GET_StudentManageData_AM]  
	 @Flag VARCHAR(100),
	 @CourseType VARCHAR(20)  ,
	 @IsPG bit  ,
	 @SessionName VARCHAR(50)  ,
	 @CourseId int  
AS  
 
  
--------//  GET_StudentManageData_AM '','',0,'2024-25',112 
   
BEGIN  
     SELECT DisplayName CourseType,CtypeID FROM AGRA_RESULT_ERP.DBO.COURSETYPEMASTER_AM WITH (NOLOCK) where IsActive=1  
	   
     
		
		IF(@CourseType='')
			BEGIN
				SELECT  * FROM AGRA_RESULT_ERP.DBO.COURSEMASTER_AM WITH (NOLOCK) where  IsActive=1 AND Session=@SessionName order BY  CourseNameReal ASC,Semester ASC
			END
			 ELSE
             BEGIN
				select  C.CourseID,C.CourseName,C.CourseNameReal,c.DisplayName,IsNew ,EntryID from AGRA_RESULT_ERP.DBO.COURSEMASTER_AM(NOLOCK)  C 
				WHERE C.EntryID IN (
				SELECT DISTINCT EntryID FROM AGRA_RESULT_ERP.DBO.COURSEANDTYPEMAP_AM(NOLOCK) CTM  
				JOIN AGRA_RESULT_ERP.DBO.COURSETYPEMASTER_AM(NOLOCK) CY  ON CTM.CTYPEID=CY.CtypeID
				WHERE CY.DisplayName=@CourseType AND c.Session=@SessionName
				)	
				 and IsPG=@IsPG and C.IsActive=1 AND c.Session=@SessionName order BY  CourseNameReal ASC,Semester ASC
             END
             

			  SELECT  SESSION_ID,SESSIONS,START_YEAR,ENDYEAR_YEAR,ISACTIVE FROM dbo.SESSION_MASTER(NOLOCK) ORDER BY ISACTIVE DESC;
       


			 SELECT DISTINCT r.EXAM_TYPE FROM AGRA_RESULT_ERP.dbo.STUDENT_RESULT(NOLOCK) r  
			 JOIN AGRA_RESULT_ERP.DBO.COURSEMASTER_AM(NOLOCK) C ON r.COURSE_ID=c.CourseID
			 WHERE c.EntryID=@CourseID AND r.SESSION=@SessionName --AND IS_ACTIVE=1 AND IS_LIVE=0



END  
GO
/****** Object:  StoredProcedure [dbo].[INSERT_UPDATE_OrdinanceDetails_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[INSERT_UPDATE_OrdinanceDetails_AM] 
(
		@FLAG  VARCHAR(100),
		@ORD_DETAILS_ID INT=0,
		@ORDINANCE_ID int,
        @PAPER_TYPE_CAT varchar(5),
        @PAPER_CREDIT int,
        @THEORY_MAX int,
        @THEORY_MIN INT,
        @THEORY_PASS_PERCENT decimal,
        @INTERNAL_MAX int,
        @INTERNAL_MIN int,
        @INTERNAL_PASS_PERCENT decimal,
        @SESSIONAL_MAX int,
        @SESSIONAL_MIN int,
        @SESSIONAL_PASS_PERCENT decimal,
        @PAPER_TOTAL_MAX int,
        @PAPER_TOTAL_MIN int,
        @PAPER_TOTAL_PASS_PERCENT decimal,
      
		@THEORY_CHECK bit,
        @INTERNAL_CHECK bit,
        @SESSIONAL_CHECK bit,
       @PAPER_TOTAL_CHECK bit,
		@EditFlag   BIT=0
)



AS
BEGIN

     
    IF(@ORD_DETAILS_ID=0) 			
    BEGIN 
      IF NOT EXISTS(SELECT 1 FROM [ORDINANCE_DETAILS] WHERE ORDINANCE_ID=@ORDINANCE_ID)
      BEGIN
        -- SELECT  @ORDINANCE_ID= ISNULL(MAX(@ORDINANCE_ID),0)+1 FROM [ORDINANCE]
            INSERT INTO [DBO].[ORDINANCE_DETAILS]
            (
              [ORDINANCE_ID], [PAPER_TYPE_CAT], [PAPER_CREDIT], [THEORY_MAX], [THEORY_MIN], [THEORY_PASS_PERCENT], [INTERNAL_MAX], [INTERNAL_MIN], [INTERNAL_PASS_PERCENT], [SESSIONAL_MAX], [SESSIONAL_MIN], [SESSIONAL_PASS_PERCENT], [PAPER_TOTAL_MAX], [PAPER_TOTAL_MIN], [PAPER_TOTAL_PASS_PERCENT], [IS_DELETED], [CREATEON], [UPDATEON],[THEORY_CHECK], [INTERNAL_CHECK], [SESSIONAL_CHECK],[PAPER_TOTAL_CHECK]
            )
     VALUES
           (
		   @ORDINANCE_ID, @PAPER_TYPE_CAT, @PAPER_CREDIT, @THEORY_MAX, @THEORY_MIN, @THEORY_PASS_PERCENT,@INTERNAL_MAX, @INTERNAL_MIN, @INTERNAL_PASS_PERCENT, @SESSIONAL_MAX, @SESSIONAL_MIN, @SESSIONAL_PASS_PERCENT, @PAPER_TOTAL_MAX, @PAPER_TOTAL_MIN, @PAPER_TOTAL_PASS_PERCENT, 0, GETDATE(), GETDATE(),@THEORY_CHECK, @INTERNAL_CHECK, @SESSIONAL_CHECK,@PAPER_TOTAL_CHECK
                
           )
         SELECT 'DATA SAVED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	 END 
   ELSE
     BEGIN 
	  SELECT 'DATA NOT SAVED SUCCESSFULLY(ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
   END 
			
    END
ELSE
 BEGIN 
   --   IF NOT EXISTS(SELECT 1 FROM ORDINANCE_DETAILS WHERE  ORD_DETAILS_ID=@ORDINANCE_ID)
	  --BEGIN
     UPDATE [DBO].[ORDINANCE_DETAILS]
      SET 
	   [ORDINANCE_ID] = @ORDINANCE_ID,
      [PAPER_TYPE_CAT] = @PAPER_TYPE_CAT, 
      [PAPER_CREDIT] = @PAPER_CREDIT, 
      [THEORY_MAX] = @THEORY_MAX, 
      [THEORY_MIN] = @THEORY_MIN,
      [THEORY_PASS_PERCENT] = @THEORY_PASS_PERCENT, 
      [INTERNAL_MAX] = @INTERNAL_MAX, 
      [INTERNAL_MIN] = @INTERNAL_MIN,
      [INTERNAL_PASS_PERCENT] = @INTERNAL_PASS_PERCENT, 
      [SESSIONAL_MAX] = @SESSIONAL_MAX,
      [SESSIONAL_MIN] = @SESSIONAL_MIN, 
      [SESSIONAL_PASS_PERCENT] = @SESSIONAL_PASS_PERCENT, 
      [PAPER_TOTAL_MAX] = @PAPER_TOTAL_MAX, 
      [PAPER_TOTAL_MIN] = @PAPER_TOTAL_MIN,
      [PAPER_TOTAL_PASS_PERCENT] = @PAPER_TOTAL_PASS_PERCENT, 
      [THEORY_CHECK] = @THEORY_CHECK, 
      [INTERNAL_CHECK] = @INTERNAL_CHECK, 
      [SESSIONAL_CHECK] = @SESSIONAL_CHECK, 
      [PAPER_TOTAL_CHECK] = @PAPER_TOTAL_CHECK, 
      [UPDATEON] = GETDATE()
     WHERE  ORD_DETAILS_ID=@ORD_DETAILS_ID
     SELECT 'DATA UPDATED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	  END 
      -- ELSE
      --  BEGIN 
	     --SELECT 'DATA NOT UPDATED SUCCESSFULLY(ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
      -- END  
-- END 




END 
GO
/****** Object:  StoredProcedure [dbo].[INSERT_UPDATE_ORDINANCEMAPPING_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[INSERT_UPDATE_ORDINANCEMAPPING_AM] 
(
		@FLAG  VARCHAR(100),
		@ORDINANCE_ID INT=0,
		@COURSE_IDLIST VARCHAR(2000),
        @PROC_NAME varchar(500),      
        @RESULT_TYPE_ID int
		
)

--  exec  [INSERT_UPDATE_ORDINANCEMAPPING_AM] '',3,'101,106','text',1

AS
BEGIN

		DECLARE @ROWCT VARCHAR(50)=''

	INSERT INTO RESULTTYPE_WISE_ORDINANCE

			SELECT  l.RESULT_TYPE_ID,l.COURSE_ID,l.ORDINANCE_ID ,l.PROC_NAME,1 [IsACTIVE] FROM ( SELECT value AS COURSE_ID ,@RESULT_TYPE_ID AS RESULT_TYPE_ID,@ORDINANCE_ID  AS ORDINANCE_ID,@PROC_NAME AS PROC_NAME FROM STRING_SPLIT(@COURSE_IDLIST,',')) AS l
			LEFT OUTER JOIN dbo.RESULTTYPE_WISE_ORDINANCE AS d ON l.ORDINANCE_ID=d.ORDINANCE_ID AND l.RESULT_TYPE_ID=d.RESULT_TYPE_ID AND d.COURSE_ID =			l.COURSE_ID
			WHERE d.COURSE_ID IS NULL

			SET @ROWCT= @@ROWCOUNT

			IF(@ROWCT>0)
			BEGIN		
			SELECT 'DATA SAVED SUCCESSFULLY.!! ('+@ROWCT+' INSERTED)' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
			END ELSE
				 SELECT 'DATA ALREADY EXISTS!!' AS RESPONSEMESSAGE, 0 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
END 
GO
/****** Object:  StoredProcedure [dbo].[INSERT_UPDATE_OrdinanceMaster_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[INSERT_UPDATE_OrdinanceMaster_AM] (
		   @FLAG			       VARCHAR(100),
		   @ORDINANCE_ID int =0,
		   @ORDINANCE_NAME nvarchar(200),
           @RESULT_TYPE_ID smallint,
           --@COURSE_ID int,
           @IS_RW bit,
           --@SESSION_ID int,
           @SUBJECT_COUNT smallint,
           @PAPER_COUNT smallint,
           @COMPULSORY_PAPER_COUNT int,
           @OPTIONAL_PAPER_COUNT int,
          
           @GRACE smallint,
           @RESULT_PASS_PERCENT decimal,
           @THEORY_MAX int,
           @THEORY_MIN int,
           @PRACTICAL_MAX int,
           @PRACTICAL_MIN int,
           @GRAND_MAX int,
           @GRAND_MIN int,
           @FINAL_YEAR_SEM bit,

           @I_DIV_MAX_CGPA_PERCENT decimal,
           @I_DIV_MIN_CGPA_PERCENT decimal,
           @II_DIV_MAX_CGPA_PERCENT decimal,
           @II_DIV_MIN_CGPA_PERCENT decimal,
           @III_DIV_MAX_CGPA_PERCENT decimal,
           @III_DIV_MIN_CGPA_PERCENT decimal,

		   @I_DIV_MAX_PRAC_PERCENT decimal,
           @I_DIV_MIN_PRAC_PERCENT decimal,
           @II_DIV_MAX_PRAC_PERCENT decimal,
           @II_DIV_MIN_PRAC_PERCENT decimal,
           @III_DIV_MAX_PRAC_PERCENT decimal,
           @III_DIV_MIN_PRAC_PERCENT decimal,

           @FAIL_PAPER_FOR_BACK int,
           @AGG_MARKS_PAPER_FOR_BACK decimal,
           --@PROC_NAME varchar(150),
           @TOTAL_MAJOR_CR INT =0,
           @SEMCREDIT INT=0,
           @TOTALCREDIT INT=0,

		   @MAJOR_PAPER_COUNT INT=0,
		   @VOCATIONAL_PAPER_COUNT INT=0,
		   @QUALIFY_PAPER_COUNT INT=0,
		   @RESEARCH_PAPER_COUNT INT=0,
		   @PRACTICAL_PAPER_COUNT INT=0,
		   @VOCATIONAL_CR INT=0,
		   @RESEARCH_CR INT=0,
		   @ALLOW_GRACE bit=0,
		   @GRACE_IF_PASSED_AGG BIT=0,
		   @GRACE_APPLY_EXAM_TYPE VARCHAR(50),
		   @TOTAL_MAX INT=0,
		   @TOTAL_MIN INT=0,
		   @ADD_PRAC_IN_TOTAL_MARKS bit=0,
		   @EditFlag	         bit=0
)



AS
BEGIN

     
    IF(@ORDINANCE_ID=0) 			
    BEGIN 
      IF NOT EXISTS(SELECT 1 FROM [ORDINANCE] WHERE ORDINANCE_NAME=@ORDINANCE_NAME )
      BEGIN
         SELECT  @ORDINANCE_ID= ISNULL(MAX(@ORDINANCE_ID),0)+1 FROM [ORDINANCE]
            INSERT INTO [DBO].[ORDINANCE]
            (
               [ORDINANCE_NAME], [RESULT_TYPE_ID], [IS_RW], [SUBJECT_COUNT], [PAPER_COUNT], [COMPULSORY_PAPER_COUNT], [OPTIONAL_PAPER_COUNT], [MAJOR_PAPER_COUNT], [VOCATIONAL_PAPER_COUNT], [QUALIFY_PAPER_COUNT], [RESEARCH_PAPER_COUNT], [PRACTICAL_PAPER_COUNT], [TOTAL_MAJOR_CR], [VOCATIONAL_CR], [RESEARCH_CR], [SEMCREDIT], [TOTALCREDIT], [ALLOW_GRACE], [GRACE], [GRACE_IF_PASSED_AGG], [GRACE_APPLY_EXAM_TYPE], [RESULT_PASS_PERCENT], [THEORY_MAX], [THEORY_MIN], [PRACTICAL_MAX], [PRACTICAL_MIN], [TOTAL_MAX], [TOTAL_MIN], [ADD_PRAC_IN_TOTAL_MARKS], [GRAND_MAX], [GRAND_MIN], [FINAL_YEAR_SEM], [I_DIV_MAX_CGPA_PERCENT], [I_DIV_MIN_CGPA_PERCENT], [II_DIV_MAX_CGPA_PERCENT], [II_DIV_MIN_CGPA_PERCENT], [III_DIV_MAX_CGPA_PERCENT], [III_DIV_MIN_CGPA_PERCENT], [I_DIV_MAX_PRAC_PERCENT], [I_DIV_MIN_PRAC_PERCENT], [II_DIV_MAX_PRAC_PERCENT], [II_DIV_MIN_PRAC_PERCENT], [III_DIV_MAX_PRAC_PERCENT], [III_DIV_MIN_PRAC_PERCENT], [FAIL_PAPER_FOR_BACK], [AGG_MARKS_PAPER_FOR_BACK]
            )
     VALUES
           (
                [DBO].PROPERCASE(@ORDINANCE_NAME), @RESULT_TYPE_ID,  @IS_RW,  @SUBJECT_COUNT, @PAPER_COUNT, @COMPULSORY_PAPER_COUNT, @OPTIONAL_PAPER_COUNT, @MAJOR_PAPER_COUNT, @VOCATIONAL_PAPER_COUNT, @QUALIFY_PAPER_COUNT, @RESEARCH_PAPER_COUNT, @PRACTICAL_PAPER_COUNT, @TOTAL_MAJOR_CR, @VOCATIONAL_CR, @RESEARCH_CR, @SEMCREDIT, @TOTALCREDIT, @ALLOW_GRACE, @GRACE, @GRACE_IF_PASSED_AGG, @GRACE_APPLY_EXAM_TYPE, @RESULT_PASS_PERCENT, @THEORY_MAX, @THEORY_MIN, @PRACTICAL_MAX, @PRACTICAL_MIN, @TOTAL_MAX, @TOTAL_MIN, @ADD_PRAC_IN_TOTAL_MARKS, @GRAND_MAX, @GRAND_MIN, @FINAL_YEAR_SEM, @I_DIV_MAX_CGPA_PERCENT, @I_DIV_MIN_CGPA_PERCENT, @II_DIV_MAX_CGPA_PERCENT, @II_DIV_MIN_CGPA_PERCENT, @III_DIV_MAX_CGPA_PERCENT, @III_DIV_MIN_CGPA_PERCENT, @I_DIV_MAX_PRAC_PERCENT, @I_DIV_MIN_PRAC_PERCENT, @II_DIV_MAX_PRAC_PERCENT, @II_DIV_MIN_PRAC_PERCENT, @III_DIV_MAX_PRAC_PERCENT, @III_DIV_MIN_PRAC_PERCENT, @FAIL_PAPER_FOR_BACK, @AGG_MARKS_PAPER_FOR_BACK
           )
         SELECT 'DATA SAVED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	 END 
   ELSE
     BEGIN 
	  SELECT 'DATA NOT SAVED SUCCESSFULLY(ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
   END 
			
    END
ELSE
 BEGIN 
      IF NOT EXISTS(SELECT 1 FROM [ORDINANCE] WHERE  ORDINANCE_ID<>@ORDINANCE_ID)
	  BEGIN
     UPDATE [DBO].[ORDINANCE]
      SET 
	  [ORDINANCE_NAME] = [DBO].PROPERCASE(@ORDINANCE_NAME)
      ,[RESULT_TYPE_ID] = @RESULT_TYPE_ID
      ,[IS_RW] = @IS_RW
      ,[SUBJECT_COUNT] = @SUBJECT_COUNT
      ,[PAPER_COUNT] = @PAPER_COUNT
      ,[COMPULSORY_PAPER_COUNT] = @COMPULSORY_PAPER_COUNT
      ,[OPTIONAL_PAPER_COUNT] = @OPTIONAL_PAPER_COUNT
      ,[MAJOR_PAPER_COUNT] = @MAJOR_PAPER_COUNT
      ,[VOCATIONAL_PAPER_COUNT] = @VOCATIONAL_PAPER_COUNT
      ,[QUALIFY_PAPER_COUNT] = @QUALIFY_PAPER_COUNT
      ,[RESEARCH_PAPER_COUNT] = @RESEARCH_PAPER_COUNT
      ,[PRACTICAL_PAPER_COUNT] = @PRACTICAL_PAPER_COUNT
      ,[TOTAL_MAJOR_CR] = @TOTAL_MAJOR_CR
      ,[VOCATIONAL_CR] = @VOCATIONAL_CR
      ,[RESEARCH_CR] = @RESEARCH_CR
      ,[SEMCREDIT] = @SEMCREDIT
      ,[TOTALCREDIT] = @TOTALCREDIT
      ,[ALLOW_GRACE] = @ALLOW_GRACE
      ,[GRACE] = @GRACE
      ,[GRACE_IF_PASSED_AGG] = @GRACE_IF_PASSED_AGG
      ,[GRACE_APPLY_EXAM_TYPE] = @GRACE_APPLY_EXAM_TYPE
      ,[RESULT_PASS_PERCENT] = @RESULT_PASS_PERCENT
      ,[THEORY_MAX] = @THEORY_MAX
      ,[THEORY_MIN] = @THEORY_MIN
      ,[PRACTICAL_MAX] = @PRACTICAL_MAX
      ,[PRACTICAL_MIN] = @PRACTICAL_MIN
      ,[TOTAL_MAX] = @TOTAL_MAX
      ,[TOTAL_MIN] = @TOTAL_MIN
      ,[ADD_PRAC_IN_TOTAL_MARKS] = @ADD_PRAC_IN_TOTAL_MARKS
      ,[GRAND_MAX] = @GRAND_MAX
      ,[GRAND_MIN] = @GRAND_MIN
      ,[FINAL_YEAR_SEM] = @FINAL_YEAR_SEM
      ,[I_DIV_MAX_CGPA_PERCENT] = @I_DIV_MAX_CGPA_PERCENT
      ,[I_DIV_MIN_CGPA_PERCENT] = @I_DIV_MIN_CGPA_PERCENT
      ,[II_DIV_MAX_CGPA_PERCENT] = @II_DIV_MAX_CGPA_PERCENT
      ,[II_DIV_MIN_CGPA_PERCENT] = @II_DIV_MIN_CGPA_PERCENT
      ,[III_DIV_MAX_CGPA_PERCENT] = @III_DIV_MAX_CGPA_PERCENT
      ,[III_DIV_MIN_CGPA_PERCENT] = @III_DIV_MIN_CGPA_PERCENT
      ,[I_DIV_MAX_PRAC_PERCENT] = @I_DIV_MAX_PRAC_PERCENT
      ,[I_DIV_MIN_PRAC_PERCENT] = @I_DIV_MIN_PRAC_PERCENT
      ,[II_DIV_MAX_PRAC_PERCENT] = @II_DIV_MAX_PRAC_PERCENT
      ,[II_DIV_MIN_PRAC_PERCENT] = @II_DIV_MIN_PRAC_PERCENT
      ,[III_DIV_MAX_PRAC_PERCENT] = @III_DIV_MAX_PRAC_PERCENT
      ,[III_DIV_MIN_PRAC_PERCENT] = @III_DIV_MIN_PRAC_PERCENT
      ,[FAIL_PAPER_FOR_BACK] = @FAIL_PAPER_FOR_BACK
      ,[AGG_MARKS_PAPER_FOR_BACK] = @AGG_MARKS_PAPER_FOR_BACK
	  
     WHERE  ORDINANCE_ID=@ORDINANCE_ID
           
           
           SELECT 'DATA UPDATED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	  END 
       ELSE
        BEGIN 
	     SELECT 'DATA NOT UPDATED SUCCESSFULLY(ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
        END  
 END 




END 
GO
/****** Object:  StoredProcedure [dbo].[Insert_UpdateCoursMaster_AM]    Script Date: 12/25/2025 4:39:30 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[Insert_UpdateCoursMaster_AM] (
 @FLAG			       VARCHAR(100),
 @COURSE_ID            INT,
 @COURSE_NAME_PROPER nVARCHAR(200),
 @COURSE_ID_MAIN	   INT,
 @COURSE_NAME		   VARCHAR(200),
 @SEM_NO				INT,
@YEAR_NO			   INT,
@COURSE_TYPE		   VARCHAR(50),
@COURSE_MODE		   VARCHAR(10),
@IS_ACTIVE		       BIT,
@IS_NEP	               BIT
)



AS
BEGIN

    IF NOT EXISTS(SELECT 1 FROM COURSE_MASTER WHERE COURSE_ID_MAIN=@COURSE_ID_MAIN AND SEM_NO=@SEM_NO)
     BEGIN
     DECLARE  @SEMESTER_NAME VARCHAR(50)= @COURSE_MODE +'-'
                                            + CASE WHEN @SEM_NO=1 THEN 'I'  
                                                   WHEN @SEM_NO=2 THEN 'II'
                                                   WHEN @SEM_NO=3 THEN 'III'
                                                   WHEN @SEM_NO=4 THEN 'IV'
                                                   WHEN @SEM_NO=5 THEN 'V'
                                                   WHEN @SEM_NO=6 THEN 'VI'
                                                   WHEN @SEM_NO=7 THEN 'VII'
                                                   WHEN @SEM_NO=8 THEN 'VIII'
                                             END 


IF(@COURSE_ID=0) 			
 BEGIN 
 SELECT  @COURSE_ID= ISNULL(MAX(COURSE_ID),0)+1 FROM COURSE_MASTER

   
  INSERT INTO [DBO].[COURSE_MASTER]
           (
            [COURSE_ID_MAIN]
           ,[COURSE_ID]
           ,[COURSE_NAME]
           ,[COURSE_NAME_PROPER]
           ,[SEM_NO]
           ,[YEAR_NO]
           ,[COURSE_TYPE]
           ,[COURSE_MODE]
           ,[IS_ACTIVE]
           ,[IS_NEP]
           ,[SEMESTER_NAME]
            )
     VALUES
           (@COURSE_ID_MAIN 
           ,@COURSE_ID 
           ,@COURSE_NAME 
           ,[DBO].PROPERCASE(@COURSE_NAME)
           ,@SEM_NO 
           ,@YEAR_NO 
           ,@COURSE_TYPE 
           ,@COURSE_MODE 
           ,@IS_ACTIVE 
           ,@IS_NEP 
           ,@SEMESTER_NAME 
          )
 


	 SELECT 'DATA SAVED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	 END 
   ELSE
     BEGIN 
	  SELECT 'DATA NOT SAVED SUCCESSFULLY(SEMESER ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
   END 
			
END
ELSE
 BEGIN 
      IF NOT EXISTS(SELECT 1 FROM COURSE_MASTER WHERE COURSE_ID_MAIN=@COURSE_ID_MAIN AND SEM_NO=@SEM_NO AND COURSE_ID<>@COURSE_ID)
	  BEGIN
	       
   UPDATE [DBO].[COURSE_MASTER]
   SET [COURSE_ID_MAIN] = @COURSE_ID_MAIN 
      ,[COURSE_NAME] = @COURSE_NAME
      ,[COURSE_NAME_PROPER] =[dbo].ProperCase(@COURSE_NAME)  
      ,[SEM_NO] =  @SEM_NO 
      ,[YEAR_NO] = @YEAR_NO 
      ,[COURSE_TYPE] = @COURSE_TYPE 
      ,[COURSE_MODE] = @COURSE_MODE 
      ,[IS_ACTIVE] = @IS_ACTIVE 
      ,[IS_NEP] = @IS_NEP 
      ,[SEMESTER_NAME] = @SEMESTER_NAME
      ,UPDATEON =GETDATE()
   WHERE  COURSE_ID=@COURSE_ID
           
           
           SELECT 'DATA UPDATED SUCCESSFULLY.!!' AS RESPONSEMESSAGE, 1 AS RESPONSECODE, 0 AS RESPONSEMESSAGECODE;
	  END 
       ELSE
        BEGIN 
	     SELECT 'DATA NOT UPDATED SUCCESSFULLY(SEMESER ALREADY EXISTS).!!' AS RESPONSEMESSAGE, -1 AS RESPONSECODE, '-100' AS RESPONSEMESSAGECODE;
        END  
 END 




END 
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'1-MARK SYSTEM, 2-CBSC,3-NEP,4-SELF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'ORDINANCE', @level2type=N'COLUMN',@level2name=N'RESULT_TYPE_ID'
GO
USE [master]
GO
ALTER DATABASE [AGRA_MASTER] SET  READ_WRITE 
GO
